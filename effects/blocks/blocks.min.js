function CHIblocks(d,f,c,a,h){function g(a){return a&&$(a).length}function w(a){return a&&/^[\+]?[0]*[1-9][\d]*$/.test(a)}function C(a){return!isNaN(a)&&/^[\+]?[\d]+$/.test(a)}function D(a,b){return Math.floor(Math.random()*(Math.max(a,b)-Math.min(a,b)))+Math.min(a,b)}function x(){k||q||(q=setTimeout(b.next,E))}function y(){clearTimeout(q);q=0}if(!g(d))return!1;f||(f="img");d=$(d).eq(0);var r=d.find(f);if(!r.length)return!1;c||(c={});a||(a={});h||(h={});var E=w(a.delay)?parseInt(a.delay)||0:5E3,m=
"auto"in a?Boolean(a.auto):!0;f="mstop"in a?Boolean(a.mstop):!0;var b={},t=[],l=w(a.h)?parseInt(a.h)||0:2;a=w(a.v)?parseInt(a.v)||0:2;var A=l*a,n=d.width()/l,p=d.height()/a;d.empty();for(a=0;a<A;a++){t.push(a);var u=[a%l,Math.floor(a/l)];d.append($("<div>").css({width:n,height:p,left:n*u[0],top:p*u[1],backgroundPosition:-n*u[0]+"px "+-p*u[1]+"px"}))}var t=t.join(","),B=d.children().css("backgroundImage","url("+r.get(0).src+")"),z=r.length,e=0,k=0;b.show=function(a){if(!k){y();k=A;C(a)||(a=e+1);a%=
z;var b=t.split(",");B.map(function(c,d){var e=D(0,b.length),g=b[e],f=[g%l,Math.floor(g/l)];b.splice(e,1);$(d).delay(100*c).fadeOut("","",function(){$(d).css({backgroundImage:"url("+r.get(a).src+")",backgroundPosition:-n*f[0]+"px "+-p*f[1]+"px"})}).delay(100).fadeIn().delay(100*c+500*z).animate({top:p*f[1],left:n*f[0]},500,"",function(){k--;h.each&&h.each.call(this,$(this).index());k||(m&&x(),h.all&&h.all(B))})});e=a;"undefined"!==typeof v&&v.eq(e).addClass("cur").siblings().removeClass("cur")}};
var q=0;b.start=function(){m=!0;x()};b.stop=function(){m=!1;y()};f&&d.mouseleave(function(){m&&x()}).mouseenter(y);b.next=function(){k||(e++,b.show(e))};b.prev=function(){k||(e=z-1+e,b.show(e))};if(g(c.indices)){var v=$(c.indices);v.eq(0).addClass("cur");v.click(function(){b.show($(this).index(c.indices))})}g(c.prev)&&$(c.prev).click(b.prev);g(c.next)&&$(c.next).click(b.next);g(c.stop)&&$(c.stop).click(b.stop);g(c.start)&&$(c.start).click(b.start);h.init&&h.init(d);m&&b.start();return b};